{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.validateDelegateSet = void 0;\nconst errors_1 = require(\"../../errors\");\nconst common_1 = require(\"./common\");\nconst PERMISSIONS_MAX_LENGTH = 10;\nconst NON_DELEGABLE_TRANSACTIONS = new Set(['AccountSet', 'SetRegularKey', 'SignerListSet', 'DelegateSet', 'AccountDelete', 'Batch', 'EnableAmendment', 'SetFee', 'UNLModify']);\nfunction validateDelegateSet(tx) {\n  (0, common_1.validateBaseTransaction)(tx);\n  (0, common_1.validateRequiredField)(tx, 'Authorize', common_1.isAccount);\n  if (tx.Authorize === tx.Account) {\n    throw new errors_1.ValidationError('DelegateSet: Authorize and Account must be different.');\n  }\n  (0, common_1.validateRequiredField)(tx, 'Permissions', Array.isArray);\n  const permissions = tx.Permissions;\n  if (permissions.length > PERMISSIONS_MAX_LENGTH) {\n    throw new errors_1.ValidationError(`DelegateSet: Permissions array length cannot be greater than ${PERMISSIONS_MAX_LENGTH}.`);\n  }\n  const permissionValueSet = new Set();\n  permissions.forEach(permission => {\n    if (permission == null || Object.keys(permission).length !== 1 || permission.Permission == null || Object.keys(permission.Permission).length !== 1) {\n      throw new errors_1.ValidationError('DelegateSet: Permissions array element is malformed');\n    }\n    const permissionValue = permission.Permission.PermissionValue;\n    if (permissionValue == null) {\n      throw new errors_1.ValidationError('DelegateSet: PermissionValue must be defined');\n    }\n    if (typeof permissionValue !== 'string') {\n      throw new errors_1.ValidationError('DelegateSet: PermissionValue must be a string');\n    }\n    if (NON_DELEGABLE_TRANSACTIONS.has(permissionValue)) {\n      throw new errors_1.ValidationError(`DelegateSet: PermissionValue contains a non-delegatable transaction ${permissionValue}`);\n    }\n    permissionValueSet.add(permissionValue);\n  });\n  if (permissions.length !== permissionValueSet.size) {\n    throw new errors_1.ValidationError('DelegateSet: Permissions array cannot contain duplicate values');\n  }\n}\nexports.validateDelegateSet = validateDelegateSet;","map":{"version":3,"names":["errors_1","require","common_1","PERMISSIONS_MAX_LENGTH","NON_DELEGABLE_TRANSACTIONS","Set","validateDelegateSet","tx","validateBaseTransaction","validateRequiredField","isAccount","Authorize","Account","ValidationError","Array","isArray","permissions","Permissions","length","permissionValueSet","forEach","permission","Object","keys","Permission","permissionValue","PermissionValue","has","add","size","exports"],"sources":["/Users/caiyongsheng/Developer/nus_fintech_project/nus_fintech_gang_plus_side_characters/frontend/node_modules/xrpl/src/models/transactions/delegateSet.ts"],"sourcesContent":["import { ValidationError } from '../../errors'\n\nimport {\n  BaseTransaction,\n  validateBaseTransaction,\n  validateRequiredField,\n  isAccount,\n  Account,\n} from './common'\n\nconst PERMISSIONS_MAX_LENGTH = 10\nconst NON_DELEGABLE_TRANSACTIONS = new Set([\n  'AccountSet',\n  'SetRegularKey',\n  'SignerListSet',\n  'DelegateSet',\n  'AccountDelete',\n  'Batch',\n  // Pseudo transactions below:\n  'EnableAmendment',\n  'SetFee',\n  'UNLModify',\n])\n\nexport interface Permission {\n  Permission: {\n    PermissionValue: string\n  }\n}\n\n/**\n * DelegateSet allows an account to delegate a set of permissions to another account.\n *\n * @category Transaction Models\n */\nexport interface DelegateSet extends BaseTransaction {\n  TransactionType: 'DelegateSet'\n\n  /**\n   * The authorized account.\n   */\n  Authorize: Account\n\n  /**\n   * The transaction permissions (represented by integers) that the account has been granted.\n   */\n  Permissions: Permission[]\n}\n\n/**\n * Verify the form and type of an DelegateSet at runtime.\n *\n * @param tx - An DelegateSet Transaction.\n * @throws When the DelegateSet is malformed.\n */\n// eslint-disable-next-line max-lines-per-function -- necessary for validation\nexport function validateDelegateSet(tx: Record<string, unknown>): void {\n  validateBaseTransaction(tx)\n\n  validateRequiredField(tx, 'Authorize', isAccount)\n\n  if (tx.Authorize === tx.Account) {\n    throw new ValidationError(\n      'DelegateSet: Authorize and Account must be different.',\n    )\n  }\n\n  validateRequiredField(tx, 'Permissions', Array.isArray)\n\n  // eslint-disable-next-line @typescript-eslint/consistent-type-assertions -- required for validation\n  const permissions = tx.Permissions as DelegateSet['Permissions']\n  if (permissions.length > PERMISSIONS_MAX_LENGTH) {\n    throw new ValidationError(\n      `DelegateSet: Permissions array length cannot be greater than ${PERMISSIONS_MAX_LENGTH}.`,\n    )\n  }\n\n  const permissionValueSet = new Set()\n  permissions.forEach((permission: Permission) => {\n    if (\n      // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition -- required for validation\n      permission == null ||\n      Object.keys(permission).length !== 1 ||\n      // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition -- required for validation\n      permission.Permission == null ||\n      Object.keys(permission.Permission).length !== 1\n    ) {\n      throw new ValidationError(\n        'DelegateSet: Permissions array element is malformed',\n      )\n    }\n    const permissionValue = permission.Permission.PermissionValue\n    // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition -- required for validation\n    if (permissionValue == null) {\n      throw new ValidationError('DelegateSet: PermissionValue must be defined')\n    }\n    if (typeof permissionValue !== 'string') {\n      throw new ValidationError('DelegateSet: PermissionValue must be a string')\n    }\n    if (NON_DELEGABLE_TRANSACTIONS.has(permissionValue)) {\n      throw new ValidationError(\n        `DelegateSet: PermissionValue contains a non-delegatable transaction ${permissionValue}`,\n      )\n    }\n    permissionValueSet.add(permissionValue)\n  })\n  if (permissions.length !== permissionValueSet.size) {\n    throw new ValidationError(\n      'DelegateSet: Permissions array cannot contain duplicate values',\n    )\n  }\n}\n"],"mappings":";;;;;;AAAA,MAAAA,QAAA,GAAAC,OAAA;AAEA,MAAAC,QAAA,GAAAD,OAAA;AAQA,MAAME,sBAAsB,GAAG,EAAE;AACjC,MAAMC,0BAA0B,GAAG,IAAIC,GAAG,CAAC,CACzC,YAAY,EACZ,eAAe,EACf,eAAe,EACf,aAAa,EACb,eAAe,EACf,OAAO,EAEP,iBAAiB,EACjB,QAAQ,EACR,WAAW,CACZ,CAAC;AAkCF,SAAgBC,mBAAmBA,CAACC,EAA2B;EAC7D,IAAAL,QAAA,CAAAM,uBAAuB,EAACD,EAAE,CAAC;EAE3B,IAAAL,QAAA,CAAAO,qBAAqB,EAACF,EAAE,EAAE,WAAW,EAAEL,QAAA,CAAAQ,SAAS,CAAC;EAEjD,IAAIH,EAAE,CAACI,SAAS,KAAKJ,EAAE,CAACK,OAAO,EAAE;IAC/B,MAAM,IAAIZ,QAAA,CAAAa,eAAe,CACvB,uDAAuD,CACxD;;EAGH,IAAAX,QAAA,CAAAO,qBAAqB,EAACF,EAAE,EAAE,aAAa,EAAEO,KAAK,CAACC,OAAO,CAAC;EAGvD,MAAMC,WAAW,GAAGT,EAAE,CAACU,WAAyC;EAChE,IAAID,WAAW,CAACE,MAAM,GAAGf,sBAAsB,EAAE;IAC/C,MAAM,IAAIH,QAAA,CAAAa,eAAe,CACvB,gEAAgEV,sBAAsB,GAAG,CAC1F;;EAGH,MAAMgB,kBAAkB,GAAG,IAAId,GAAG,EAAE;EACpCW,WAAW,CAACI,OAAO,CAAEC,UAAsB,IAAI;IAC7C,IAEEA,UAAU,IAAI,IAAI,IAClBC,MAAM,CAACC,IAAI,CAACF,UAAU,CAAC,CAACH,MAAM,KAAK,CAAC,IAEpCG,UAAU,CAACG,UAAU,IAAI,IAAI,IAC7BF,MAAM,CAACC,IAAI,CAACF,UAAU,CAACG,UAAU,CAAC,CAACN,MAAM,KAAK,CAAC,EAC/C;MACA,MAAM,IAAIlB,QAAA,CAAAa,eAAe,CACvB,qDAAqD,CACtD;;IAEH,MAAMY,eAAe,GAAGJ,UAAU,CAACG,UAAU,CAACE,eAAe;IAE7D,IAAID,eAAe,IAAI,IAAI,EAAE;MAC3B,MAAM,IAAIzB,QAAA,CAAAa,eAAe,CAAC,8CAA8C,CAAC;;IAE3E,IAAI,OAAOY,eAAe,KAAK,QAAQ,EAAE;MACvC,MAAM,IAAIzB,QAAA,CAAAa,eAAe,CAAC,+CAA+C,CAAC;;IAE5E,IAAIT,0BAA0B,CAACuB,GAAG,CAACF,eAAe,CAAC,EAAE;MACnD,MAAM,IAAIzB,QAAA,CAAAa,eAAe,CACvB,uEAAuEY,eAAe,EAAE,CACzF;;IAEHN,kBAAkB,CAACS,GAAG,CAACH,eAAe,CAAC;EACzC,CAAC,CAAC;EACF,IAAIT,WAAW,CAACE,MAAM,KAAKC,kBAAkB,CAACU,IAAI,EAAE;IAClD,MAAM,IAAI7B,QAAA,CAAAa,eAAe,CACvB,gEAAgE,CACjE;;AAEL;AAvDAiB,OAAA,CAAAxB,mBAAA,GAAAA,mBAAA","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}